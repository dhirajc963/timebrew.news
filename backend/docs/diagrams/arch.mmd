graph TB
    %% Styling
    classDef lambda fill:#FF9900,stroke:#232F3E,stroke-width:2px,color:white
    classDef api fill:#FF9900,stroke:#232F3E,stroke-width:2px,color:white
    classDef stepfunctions fill:#FF4B6D,stroke:#232F3E,stroke-width:2px,color:white
    classDef eventbridge fill:#FF4B6D,stroke:#232F3E,stroke-width:2px,color:white
    classDef database fill:#3F48CC,stroke:#232F3E,stroke-width:2px,color:white
    classDef external fill:#146EB4,stroke:#232F3E,stroke-width:2px,color:white
    classDef user fill:#232F3E,stroke:#FF9900,stroke-width:3px,color:white

    %% Users and Frontend
    User[ğŸ‘¤ User<br/>Bolt.new Frontend]:::user
    
    %% API Gateway Layer
    subgraph "ğŸŒ API Gateway - REST API Triggers"
        API1[ğŸ” POST /auth/register]:::api
        API2[ğŸ“° GET /brews]:::api
        API3[ğŸ“° POST /brews]:::api
        API4[ğŸ“‹ GET /briefings]:::api
        API5[ğŸ’¬ POST /feedback]:::api
        API6[ğŸ”„ POST /trigger-brew]:::api
        API7[â¤ï¸ GET /health]:::api
    end

    %% Lambda Functions - API Endpoints
    subgraph "âš¡ Lambda Functions - API Endpoints"
        L1[ğŸ” register.py]:::lambda
        L2[ğŸ“° get.py]:::lambda
        L3[ğŸ“° create.py]:::lambda
        L4[ğŸ“‹ get.py]:::lambda
        L5[ğŸ’¬ submit.py]:::lambda
        L6[ğŸ”„ trigger_brew.py]:::lambda
        L7[â¤ï¸ health.py]:::lambda
    end

    %% EventBridge Scheduler
    EB[â° EventBridge<br/>rate(15 minutes)]:::eventbridge

    %% Lambda Functions - Core Services
    subgraph "ğŸ¤– Lambda Functions - AI Pipeline"
        L8[ğŸ“Š brew_scheduler.py]:::lambda
        L9[ğŸ” news_curator.py]:::lambda
        L10[âœï¸ news_editor.py]:::lambda
        L11[ğŸ“§ email_dispatcher.py]:::lambda
    end

    %% Step Functions
    SF[ğŸ”„ Step Functions<br/>AI Pipeline Orchestrator]:::stepfunctions

    %% External Services
    subgraph "ğŸŒ External Services"
        AI1[ğŸ§  OpenAI API<br/>GPT-4]:::external
        AI2[ğŸ§  Perplexity API<br/>News Search]:::external
        SMTP[ğŸ“® SMTP Server<br/>Email Delivery]:::external
        COGNITO[ğŸ” AWS Cognito<br/>Authentication]:::external
    end

    %% Database
    DB[(ğŸ—„ï¸ PostgreSQL RDS<br/>â€¢ Users & Brews<br/>â€¢ Run Tracker<br/>â€¢ Content Logs)]:::database

    %% Connections - API Layer
    User --> API1
    User --> API2
    User --> API3
    User --> API4
    User --> API5
    User --> API6
    User --> API7

    API1 --> L1
    API2 --> L2
    API3 --> L3
    API4 --> L4
    API5 --> L5
    API6 --> L6
    API7 --> L7

    %% Lambda to Services
    L1 --> COGNITO
    L1 --> DB
    L2 --> DB
    L3 --> DB
    L4 --> DB
    L5 --> DB
    L6 --> SF
    L7 --> DB

    %% Scheduler Flow
    EB --> L8
    L8 --> DB
    L8 --> SF

    %% Step Functions Orchestration
    SF --> L9
    SF --> L10
    SF --> L11

    %% AI Pipeline Connections
    L9 --> AI2
    L9 --> AI1
    L9 --> DB
    L10 --> AI1
    L10 --> DB
    L11 --> SMTP
    L11 --> DB

    %% Data Flow Labels
    L9 -.->|"ğŸ“° Curated Articles"| L10
    L10 -.->|"âœï¸ Formatted Content"| L11
    L11 -.->|"ğŸ“§ Email Delivered"| User